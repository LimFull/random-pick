# 계획 검증

구현 계획이 올바르게 실행되었는지 검증하고, 모든 성공 기준을 확인하며, 편차나 문제를 식별하는 것이 당신의 임무입니다.

## 초기 설정

호출될 때:

1. **컨텍스트 결정** - 기존 대화에 있거나 새로 시작하는가?
   - 기존인 경우: 이 세션에서 구현된 것을 검토하세요
   - 새로 시작하는 경우: git과 코드베이스 분석을 통해 수행된 것을 발견해야 합니다

2. **계획 위치 찾기**:
   - 계획 경로가 제공된 경우, 그것을 사용하세요
   - 그렇지 않으면, 최근 커밋에서 계획 참조를 검색하거나 사용자에게 물어보세요

3. **구현 증거 수집**:

   ```bash
   # 최근 커밋 확인
   git log --oneline -n 20
   git diff HEAD~N..HEAD  # N은 구현 커밋을 포함

   # 포괄적인 검사 실행
   cd $(git rev-parse --show-toplevel)
   npm run build --workspaces
   npm run test --workspace=backend  # 백엔드에만 테스트가 있음
   npm run lint --workspaces
   ```

## 검증 프로세스

### 1단계: 컨텍스트 발견

새로 시작하거나 더 많은 컨텍스트가 필요한 경우:

1. **구현 계획을 완전히 읽으세요**
2. **변경되어야 할 것을 식별하세요**:
   - 수정되어야 하는 모든 파일을 나열하세요
   - 모든 성공 기준을 기록하세요 (자동화된 것과 수동적인 것)
   - 검증해야 할 핵심 기능을 식별하세요

3. **구현을 발견하기 위해 병렬 연구 작업을 생성하세요**:

   ```
   작업 1 - 데이터베이스 변경사항 검증:
   TypeORM 엔티티가 업데이트되었고 스키마 변경사항이 계획과 일치하는지 연구하세요.
   확인: packages/backend/src/의 엔티티 파일들, 마이그레이션 스크립트, 테이블 구조
   반환: 구현된 것 vs 계획에서 명시된 것

   작업 2 - 백엔드 코드 변경사항 검증:
   [기능]과 관련된 packages/backend/src/의 모든 수정된 파일을 찾으세요.
   실제 변경사항을 계획 사양과 비교하세요.
   반환: 계획된 것 vs 실제의 파일별 비교

   작업 3 - 프론트엔드 코드 변경사항 검증:
   [기능]과 관련된 packages/frontend/src/의 모든 수정된 파일을 찾으세요.
   React 컴포넌트, API 호출, UI 통합을 확인하세요.
   반환: 프론트엔드 구현 상태

   작업 4 - 테스트 커버리지 검증:
   명시된 대로 테스트가 추가/수정되었는지 확인하세요.
   테스트 명령을 실행하고 결과를 캡처하세요.
   반환: 테스트 상태와 누락된 커버리지
   ```

### 2단계: 체계적 검증

계획의 각 단계에 대해:

1. **완료 상태 확인**:
   - 계획에서 체크마크를 찾으세요 (- [x])
   - 실제 코드가 주장된 완료와 일치하는지 확인하세요

2. **자동화된 검증 실행**:
   - "자동화된 검증"의 각 명령을 실행하세요
   - 통과/실패 상태를 문서화하세요
   - 실패가 있으면 근본 원인을 조사하세요

3. **수동 기준 평가**:
   - 수동 테스트가 필요한 것을 나열하세요
   - 사용자 검증을 위한 명확한 단계를 제공하세요

4. **엣지 케이스에 대해 깊이 생각하세요**:
   - 오류 조건이 처리되었나요?
   - 누락된 검증이 있나요?
   - 구현이 기존 기능을 깨뜨릴 수 있나요?

### 3단계: 검증 보고서 생성

포괄적인 검증 요약을 생성하세요:

```markdown
## 검증 보고서: [계획 이름]

### 구현 상태

✓ 1단계: [이름] - 완전히 구현됨
✓ 2단계: [이름] - 완전히 구현됨
⚠️ 3단계: [이름] - 부분적으로 구현됨 (문제 참조)

### 자동화된 검증 결과

✓ 빌드 통과: `npm run build --workspaces`
✓ 백엔드 테스트 통과: `npm run test --workspace=backend`
✓ 프론트엔드가 성공적으로 빌드됨: `npm run build --workspace=frontend`
✗ 린팅 문제: `npm run lint --workspaces` (3개 경고)

### 코드 리뷰 발견사항

#### 계획과 일치:

- 데이터베이스 마이그레이션이 올바르게 [테이블]을 추가함
- API 엔드포인트가 명시된 메서드를 구현함
- 오류 처리가 계획을 따름

#### 계획에서 벗어남:

- [file:line]에서 다른 변수 이름을 사용함
- [file:line]에서 추가 검증을 추가함 (개선)

#### 잠재적 문제:

- 외래 키에 인덱스가 없어 성능에 영향을 줄 수 있음
- 마이그레이션에 롤백 처리가 없음

### 수동 테스트 필요:

1. UI 기능 (localhost:3002):
   - [ ] [기능]이 프론트엔드에서 올바르게 나타나는지 확인
   - [ ] 잘못된 입력으로 오류 상태 테스트
   - [ ] 모바일 기기에서 반응형 디자인 확인

2. 백엔드 API (localhost:3001):
   - [ ] API 엔드포인트가 올바르게 작동하는지 확인
   - [ ] 데이터베이스 작업과 마이그레이션 테스트
   - [ ] 대용량 데이터셋으로 성능 확인

3. 통합:
   - [ ] 프론트엔드-백엔드 통신이 작동하는지 확인
   - [ ] 기존 스케줄러와 notion 모듈로 테스트

### 권장사항:

- 병합 전에 린팅 경고 해결
- [시나리오]에 대한 통합 테스트 추가 고려
- README.md에 새 API 엔드포인트 문서화
- 데이터베이스 스키마가 변경된 경우 TypeORM 엔티티 업데이트
- 해당하는 경우 Docker 배포 테스트
```

## 기존 컨텍스트와 함께 작업하기

구현의 일부였다면:

- 대화 기록을 검토하세요
- 완료된 것을 확인하기 위해 할 일 목록을 확인하세요
- 이 세션에서 수행된 작업에 검증을 집중하세요
- 단축키나 불완전한 항목에 대해 정직하세요

## 중요한 가이드라인

1. **철저하지만 실용적으로** - 중요한 것에 집중하세요
2. **모든 자동화된 검사를 실행하세요** - 검증 명령을 건너뛰지 마세요
3. **모든 것을 문서화하세요** - 성공과 문제 모두
4. **비판적으로 생각하세요** - 구현이 진정으로 문제를 해결하는지 질문하세요
5. **유지보수를 고려하세요** - 이것이 장기적으로 유지 가능할까요?

## 검증 체크리스트

항상 확인하세요:

- [ ] 완료로 표시된 모든 단계가 실제로 완료됨
- [ ] 백엔드 테스트 통과 (`npm run test --workspace=backend`)
- [ ] 프론트엔드가 성공적으로 빌드됨 (`npm run build --workspace=frontend`)
- [ ] 코드가 기존 패턴을 따름 (scheduler, notion 모듈 확인)
- [ ] 프론트엔드에서 회귀가 도입되지 않음 (localhost:3002)
- [ ] 백엔드에서 회귀가 도입되지 않음 (localhost:3001)
- [ ] 오류 처리가 견고함
- [ ] TypeORM 엔티티가 적절히 업데이트됨
- [ ] 필요시 문서가 업데이트됨 (README.md)
- [ ] 수동 테스트 단계가 명확함

## 다른 명령과의 관계

권장 워크플로우:

1. `/implement_plan` - 구현 실행
2. `/commit` - 변경사항에 대한 원자적 커밋 생성
3. `/validate_plan` - 구현 정확성 검증
4. `/describe_pr` - PR 설명 생성

검증은 커밋이 생성된 후에 가장 잘 작동합니다. 구현된 것을 이해하기 위해 git 기록을 분석할 수 있기 때문입니다.

기억하세요: 좋은 검증은 문제가 프로덕션에 도달하기 전에 문제를 잡아냅니다. 격차나 개선사항을 식별할 때 건설적이지만 철저하게 하세요.
