# 경마 게임 구현 요구사항

이 문서는 AI에게 경마 게임 기능을 추가 구현하도록 요청하는 요구사항 문서입니다.

## 프로젝트 개요

현재 프로젝트는 "참가 인원 관리" 탭과 "돌림판" 탭으로 구성되어 있습니다. 여기에 "경마" 탭을 추가하여 경마 게임 기능을 구현해야 합니다.

## 주요 요구사항

### 1. 프로젝트 구조 및 패턴 준수
- 현재 프로젝트에서 사용되고 있는 파일 구조와 패턴을 따라야 합니다.
- 기존 컴포넌트 구조 (`src/components/`), 훅 구조 (`src/hooks/`), 유틸리티 구조 (`src/utils/`)를 참고하여 일관성 있게 구현해야 합니다.
- 기존 스타일링 패턴과 네이밍 컨벤션을 유지해야 합니다.

### 2. 경마 탭 추가
- 현재 "참가 인원 관리" 탭과 "돌림판" 탭이 있는데, 여기에 "경마" 탭을 추가해야 합니다.
- 탭 네비게이션은 `src/App.jsx`의 기존 패턴을 따라 구현해야 합니다.
- 경마 탭은 참가자가 없을 경우 비활성화되거나 안내 메시지를 표시해야 합니다.

### 3. 참가 인원 연동
- 참가 인원 관리 탭에서 작성한 참가 인원이 경마 게임에서 사용됩니다.
- 참가 인원은 `useLocalStorage` 훅을 통해 관리되며, 경마 게임에서도 동일한 데이터를 참조해야 합니다.

### 4. 경마 게임 시작 상태
- 경마 게임은 참가 인원만큼의 말이 출발선에 서있는 상태로 시작합니다.
- 시작 버튼을 누르면 말들이 달리기 시작합니다.

### 5. 말의 색상 구분
- 모든 말은 색깔이 확실히 구분할 수 있게 달라야 합니다.
- 색상은 시각적으로 명확하게 구분 가능해야 합니다.

### 6. 참가 인원별 고유 색상 부여
- 참가 인원 관리 탭에서 인원을 추가할 때마다 각 인원은 고유의 색깔을 가지고 등록되어야 합니다.
- 색상은 자동으로 할당되며, 중복되지 않아야 합니다.
- 색상 정보는 로컬 스토리지에 저장되어야 합니다.

### 7. 색상 일관성 유지
- 참가 인원 관리 탭에서 각 인원이 부여받은 색깔은 돌림판, 경마게임에도 적용되어야 합니다.
- 돌림판의 각 섹션도 해당 참가자의 색상으로 표시되어야 합니다.
- 경마 게임의 말도 해당 참가자의 색상으로 표시되어야 합니다.

### 8. 말에 참가자 이름 표시
- 경마게임의 각 말에는 각 참가 인원의 이름이 적혀있어야 합니다.
- 이름은 명확하게 읽을 수 있도록 표시되어야 합니다.

### 9. 랜덤 속도 변화
- 게임이 시작되면 각 말은 랜덤하게 속도가 변하며 달리기 시작합니다.
- 속도가 변하는 주기는 1~5초로 랜덤입니다.
- 각 말은 각각 별개의 랜덤 주기를 가집니다.
- 한 번 속도가 변할 때마다 주기도 다시 랜덤으로 설정되어야 합니다.

### 10. 게임 종료 및 우승자 축하 팝업
- 가장 마지막 말까지 결승선에 도달하면 게임이 끝납니다.
- 게임 종료 후 우승자를 축하하는 팝업이 뜹니다.
- 팝업은 돌림판의 당첨 팝업(`src/components/WinnerDisplay.jsx`)을 참고하여 구현해야 합니다.
- 폭죽 이펙트 등 축하 애니메이션을 포함해야 합니다.

### 11. 가로 화면 레이아웃
- 경마 게임 화면은 가로로 길어야 하기 때문에 가로로 눕힌 화면으로 개발해야 합니다.
- 핸드폰 기준 세로모드를 유지한 채로 가로로 돌려서 본다고 생각하면 됩니다.
- CSS의 `transform: rotate(90deg)` 또는 `orientation: landscape` 등을 활용하여 구현할 수 있습니다.
- 화면 회전 시에도 UI가 정상적으로 표시되어야 합니다.

### 12. 말 달리기 애니메이션
- 말은 역동성을 위해 달리는 애니메이션이 구현되어야 합니다.
- 게임 엔진의 스프라이트 애니메이션 기능을 활용하여 구현해야 합니다.
- 말 이미지는 `public/images/horse` 폴더에 있는 `tile000.png` ~ `tile011.png` (총 12장) 달리는 애니메이션 이미지를 사용해야 합니다.
- 게임 엔진의 스프라이트 시트 또는 이미지 시퀀스 기능을 사용하여 12장의 이미지를 순차적으로 재생하는 애니메이션을 구현해야 합니다.
- 말 이미지의 말은 검정색이므로, 각 플레이어의 색상에 맞게 이미지를 수정하여 사용해야 합니다.
- 게임 엔진의 색상 필터 또는 쉐이더 기능을 활용하여 원본 이미지의 검정색 부분을 각 플레이어의 색상으로 변경할 수 있습니다.

### 13. 벨트스크롤 방식 화면
- 경마 게임은 벨트스크롤 방식의 화면으로 진행되어야 합니다.
- 게임 엔진의 카메라 또는 스크롤 기능을 활용하여 구현해야 합니다.
- 배경이 이동하고, 말들은 서로 엎치락 뒤치락 앞뒤로 이동하는 것처럼 보이는 방식으로 구현해야 합니다.
- 말들의 상대적 위치가 동적으로 변경되며, 시각적으로 역동적인 경마 경주를 표현해야 합니다.
- 게임 엔진의 물리 엔진 또는 위치 업데이트 로직을 통해 각 말의 진행 상황에 따라 화면상의 위치가 실시간으로 변경되어야 합니다.

## 기술 스택 및 참고사항

- **프레임워크**: React (Vite)
- **게임 엔진**: 자바스크립트 게임 엔진을 이용하여 구현해야 합니다.
  - 구현할 기능(벨트스크롤, 스프라이트 애니메이션, 카메라 제어, 색상 필터/쉐이더 등)에 따라 적절한 게임 엔진을 선택해야 합니다.
  - 스프라이트 애니메이션과 벨트스크롤 기능을 지원하는 엔진이 필요합니다.
  - 예: Phaser (2D 게임에 적합, 스프라이트 애니메이션 및 카메라 지원), PixiJS (고성능 2D 렌더링, 필터/쉐이더 지원), Three.js (3D 필요 시), Matter.js (물리 엔진, 필요 시 추가) 등
- **스타일링**: CSS 모듈 (`.css` 파일)
- **상태 관리**: React Hooks (`useState`, `useEffect` 등)
- **로컬 스토리지**: `useLocalStorage` 훅 사용
- **참고 컴포넌트**:
  - `src/components/ParticipantList.jsx` - 참가 인원 관리
  - `src/components/RouletteWheel.jsx` - 돌림판 구현
  - `src/components/WinnerDisplay.jsx` - 당첨자 팝업
- **참고 유틸리티**:
  - `src/utils/winnerSelection.js` - 당첨자 선정 로직

## 구현 시 고려사항

1. **성능 최적화**: 여러 말의 애니메이션이 동시에 실행되므로 성능을 고려해야 합니다.
   - 게임 엔진의 배치 렌더링, 객체 풀링 등의 최적화 기법을 활용해야 합니다.
   - 스프라이트 애니메이션의 프레임 레이트를 적절히 조절하여 성능과 시각적 품질의 균형을 맞춰야 합니다.
2. **반응형 디자인**: 다양한 화면 크기에서 정상 작동해야 합니다.
3. **접근성**: 키보드 네비게이션 및 스크린 리더 지원을 고려해야 합니다.
4. **에러 처리**: 참가자가 없거나 게임 중 오류가 발생할 경우 적절한 처리가 필요합니다.
5. **게임 재시작**: 게임 종료 후 다시 시작할 수 있는 기능이 필요합니다.
6. **게임 엔진 통합**: React 컴포넌트와 게임 엔진의 라이프사이클을 적절히 연동해야 합니다.
   - 컴포넌트 마운트 시 게임 엔진 초기화, 언마운트 시 리소스 정리 등이 필요합니다.

## 파일 구조 예상

구현 시 다음과 같은 파일들이 생성될 것으로 예상됩니다:

```
src/
  components/
    HorseRace.jsx          # 경마 게임 메인 컴포넌트
    HorseRace.css          # 경마 게임 스타일
    Horse.jsx              # 말 컴포넌트 (선택사항)
    Horse.css              # 말 스타일 (선택사항)
  utils/
    colorAssignment.js     # 색상 할당 유틸리티 (선택사항)
    horseRaceLogic.js      # 경마 게임 로직 (선택사항)
```

## 추가 요청사항

- 구현 시 기존 코드의 품질과 일관성을 유지해주세요.
- 주석을 적절히 작성하여 코드의 가독성을 높여주세요.
- 필요시 기존 컴포넌트도 수정하여 색상 기능을 추가할 수 있습니다.
